version: 2
jobs:
   build:
     docker:
       - image: circleci/python:3.6
     steps:
       - checkout
       - restore_cache:
           key: deps-{{ .Branch }}-{{ checksum "requirements.txt" }}
       - run: sudo pip install -r requirements.txt
       - run: sudo pip install nose flake8
       - save_cache:
           key: deps-{{ .Branch }}-{{ checksum "requirements.txt" }}
           paths:
             - /root/.cache/pip
       - run: nosetests -v
       - run: flake8 --exclude=.direnv
